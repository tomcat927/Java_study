# Redis 6为什么引入了多线程

<font style="color:rgba(0, 0, 0, 0.82);">在Redis 6.0中引入多线程的主要原因是为了提高其网络处理的效率，尤其是在网络 I/O 上。以前版本的Redis是纯粹的单线程模式，这主要限制在网络请求的读写上。Redis本身的命令执行是非常快的，但在处理大量小请求时，网络通信尤其是数据发送和接受的处理可能会成为瓶颈。</font>

<font style="color:rgba(0, 0, 0, 0.82);">以下是Redis 6.0引入多线程的一些主要原因和优势：</font>

1. **<font style="color:rgba(0, 0, 0, 0.82);">网络I/O瓶颈</font>**<font style="color:rgba(0, 0, 0, 0.82);">：在之前的纯单线程版本中，如果有非常多的小请求需要处理，网络I/O（数据包的解析和写入等）可能会限制整体吞吐量。通过引入多线程，Redis能够并行化网络数据的读写，从而克服这一瓶颈。</font>
2. **<font style="color:rgba(0, 0, 0, 0.82);">提升带宽利用率</font>**<font style="color:rgba(0, 0, 0, 0.82);">：通过多线程处理，可以更好地利用网络带宽，尤其是在大数据量传输的情形下，能够显著减少单线程造成的等待时间。</font>
3. **<font style="color:rgba(0, 0, 0, 0.82);">降低延迟</font>**<font style="color:rgba(0, 0, 0, 0.82);">：并行处理网络请求可以减少请求排队的时间，从而降低请求的平均延迟，提高Redis在高并发场景下的响应速度。</font>
4. **<font style="color:rgba(0, 0, 0, 0.82);">充分利用多核CPU</font>**<font style="color:rgba(0, 0, 0, 0.82);">：现代服务器通常具有多核CPU架构，单线程模式无法充分利用多核的优势。引入多线程后，可以更好地利用多核资源，提升Redis的整体吞吐量。</font>
5. **<font style="color:rgba(0, 0, 0, 0.82);">略微改变的工作模型</font>**<font style="color:rgba(0, 0, 0, 0.82);">：Redis 6.0中，多线程主要用来处理请求的网络 I/O，而实际的命令执行仍然在单线程中进行。这种设计避免了多线程对数据一致性和命令原子性的影响，同时提升了网络处理的效率。</font>

<font style="color:rgba(0, 0, 0, 0.82);">通过在保持核心单线程模型的情况下引入多线程来处理I/O，Redis 6.0能够在一定程度上提升性能，特别是在网络通信方面，而不引入多线程代码中常见的数据并发问题。这个设计让Redis可以在拥有更多资源的现代硬件上发挥更大潜力。</font>



> 更新: 2024-08-07 19:34:02  
> 原文: <https://www.yuque.com/tulingzhouyu/db22bv/dv91n3x7ctwu21y1>